import{h as c,c as F,b1 as ee,b2 as ae,r as v,M as oe,am as te,an as re,o as ie,d as se,g as ne,b3 as le,B as U,f as ue,aE as ce,b4 as de,_ as me,V as pe,W as fe,aZ as ve,a as ge,X as y,a6 as B,$ as i,Z as g,aO as he,a8 as H,a9 as l,a5 as T,a3 as N,a1 as q,Y as $,b5 as A,a2 as R,aX as be,a$ as ye,a0 as we,b0 as Ve,a7 as Se,ai as ke,aj as Ce}from"./index.2c40a3de.js";import{Q as qe}from"./QTd.0142695c.js";import{Q as Pe}from"./QTable.ff918da3.js";import{Q as _e}from"./QPage.11094d3e.js";import{u as Qe}from"./use-quasar.ea3b5bb2.js";import{api as D}from"./axios.a54ba107.js";import"./QItem.0442ccdd.js";const Te=[c("g",[c("path",{fill:"none",stroke:"currentColor","stroke-width":"5","stroke-miterlimit":"10",d:"M58.4,51.7c-0.9-0.9-1.4-2-1.4-2.3s0.5-0.4,1.4-1.4 C70.8,43.8,79.8,30.5,80,15.5H70H30H20c0.2,15,9.2,28.1,21.6,32.3c0.9,0.9,1.4,1.2,1.4,1.5s-0.5,1.6-1.4,2.5 C29.2,56.1,20.2,69.5,20,85.5h10h40h10C79.8,69.5,70.8,55.9,58.4,51.7z"}),c("clipPath",{id:"uil-hourglass-clip1"},[c("rect",{x:"15",y:"20",width:" 70",height:"25"},[c("animate",{attributeName:"height",from:"25",to:"0",dur:"1s",repeatCount:"indefinite",values:"25;0;0",keyTimes:"0;0.5;1"}),c("animate",{attributeName:"y",from:"20",to:"45",dur:"1s",repeatCount:"indefinite",values:"20;45;45",keyTimes:"0;0.5;1"})])]),c("clipPath",{id:"uil-hourglass-clip2"},[c("rect",{x:"15",y:"55",width:" 70",height:"25"},[c("animate",{attributeName:"height",from:"0",to:"25",dur:"1s",repeatCount:"indefinite",values:"0;25;25",keyTimes:"0;0.5;1"}),c("animate",{attributeName:"y",from:"80",to:"55",dur:"1s",repeatCount:"indefinite",values:"80;55;55",keyTimes:"0;0.5;1"})])]),c("path",{d:"M29,23c3.1,11.4,11.3,19.5,21,19.5S67.9,34.4,71,23H29z","clip-path":"url(#uil-hourglass-clip1)",fill:"currentColor"}),c("path",{d:"M71.6,78c-3-11.6-11.5-20-21.5-20s-18.5,8.4-21.5,20H71.6z","clip-path":"url(#uil-hourglass-clip2)",fill:"currentColor"}),c("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"180 50 50",repeatCount:"indefinite",dur:"1s",values:"0 50 50;0 50 50;180 50 50",keyTimes:"0;0.7;1"})])];var G=F({name:"QSpinnerHourglass",props:ee,setup(e){const{cSize:r,classes:w}=ae(e);return()=>c("svg",{class:w.value,width:r.value,height:r.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},Te)}}),L=F({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:r,emit:w}){const j=ne(),V=v(null);let u=0;const o=[];function S(t){const m=typeof t=="boolean"?t:e.noErrorFocus!==!0,n=++u,p=(s,f)=>{w("validation"+(s===!0?"Success":"Error"),f)},C=s=>{const f=s.validate();return typeof f.then=="function"?f.then(h=>({valid:h,comp:s}),h=>({valid:!1,comp:s,err:h})):Promise.resolve({valid:f,comp:s})};return(e.greedy===!0?Promise.all(o.map(C)).then(s=>s.filter(f=>f.valid!==!0)):o.reduce((s,f)=>s.then(()=>C(f).then(h=>{if(h.valid===!1)return Promise.reject(h)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return n===u&&p(!0),!0;if(n===u){const{comp:f,err:h}=s[0];if(h!==void 0&&console.error(h),p(!1,f),m===!0){const E=s.find(({comp:I})=>typeof I.focus=="function"&&le(I.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function P(){u++,o.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function _(t){t!==void 0&&U(t);const m=u+1;S().then(n=>{m===u&&n===!0&&(e.onSubmit!==void 0?w("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function k(t){t!==void 0&&U(t),w("reset"),ue(()=>{P(),e.autofocus===!0&&e.noResetFocus!==!0&&d()})}function d(){ce(()=>{if(V.value===null)return;const t=V.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||V.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||V.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(V.value.querySelectorAll("[tabindex]"),m=>m.tabIndex>-1);t!=null&&t.focus({preventScroll:!0})})}oe(de,{bindComponent(t){o.push(t)},unbindComponent(t){const m=o.indexOf(t);m>-1&&o.splice(m,1)}});let Q=!1;return te(()=>{Q=!0}),re(()=>{Q===!0&&e.autofocus===!0&&d()}),ie(()=>{e.autofocus===!0&&d()}),Object.assign(j.proxy,{validate:S,resetValidation:P,submit:_,reset:k,focus:d,getValidationComponents:()=>o}),()=>c("form",{class:"q-form",ref:V,onSubmit:_,onReset:k},se(r.default))}});const Ae=c("div",{class:"q-space"});var Be=F({name:"QSpace",setup(){return()=>Ae}});const Ee=pe({name:"AddProduct",props:{id:{type:String,required:!1}},setup(e,{emit:r}){const w=Qe(),j=fe(),V=ve(),u=v(),o=v(),S=v(),P=v(),_=v(0),k=v([]),d=v(!1),Q=v(!1),t=v(!0),m=v(!1),n=v({error:null,type:null}),p=v({id:null,referencia:null,precio:null,descripcion:null}),C=v(!0),z=[{name:"referencia",label:"Referencia",align:"left",field:"referencia",sortable:!0},{name:"precio",label:"Precio",align:"left",field:"precio",sortable:!0},{name:"descripcion",label:"Descripcion",align:"left",field:"descripcion",sortable:!0},{name:"accion",label:"Accion",align:"left",field:"accion"}],s=()=>{if(n.value.error=null,n.value.type=null,!Q.value)return M();h()},f=()=>{t.value=!t.value},h=async()=>{if(u.value)try{d.value=!0;const{data:a}=await D.put(`/producto/${u.value}`,{nombre:o.value,referencia:S.value,descripcion:P.value,precio:_.value});E(a.data),w.dialog({title:"Alerta",message:"Producto Actualizado"}),d.value=!1,f()}catch(a){n.value.error=a.response.data.errors,n.value.type="producto",d.value=!1,m.value=!0}},E=a=>{var b;o.value=a.nombre,S.value=a.referencia,P.value=a.descripcion,_.value=a.precio,((b=a.variaciones)==null?void 0:b.length)>0&&(k.value=a.variaciones)},I=async()=>{if(u.value){const{data:a}=await D.get(`/producto/${u.value}`);E(a.data)}};(()=>{V.params.id&&(u.value=V.params.id,Q.value=!0,I())})();const M=async()=>{d.value=!0;try{const{data:a,status:b}=await D.post("/producto",{nombre:o.value,referencia:S.value,descripcion:P.value,precio:_.value});b===201&&(d.value=!1,Q.value=!0,u.value=a.data.id,j.push({name:"EditProduct",params:{id:a.data.id}}))}catch(a){n.value.error=a.response.data.errors,n.value.type="producto",d.value=!1,m.value=!0}},X=ge(()=>e.id?"Modificar Producto":"Crear Producto"),Y=a=>{const b=p.value;b.referencia=a.row.referencia,b.precio=a.row.precio,b.descripcion=a.row.descripcion,b.id=a.row.id,C.value=!C.value},x=()=>{C.value=!C.value;const a=p.value;a.referencia=null,a.precio=null,a.descripcion=null,a.id=null},Z=()=>{if(n.value.error=null,n.value.type=null,!p.value.id)return K();W()},K=async()=>{try{const{data:a}=await D.post("/variacion",{referencia:p.value.referencia,precio:p.value.precio,descripcion:p.value.descripcion,producto_id:u.value});k.value.push(a.data),w.dialog({title:"Alerta",message:"Se creo una nueva variacion."}),x()}catch(a){n.value.error=a.response.data.errors,n.value.type="variacion",d.value=!1,m.value=!0}},W=async()=>{try{const{data:a}=await D.put(`/variacion/${p.value.id}`,{referencia:p.value.referencia,precio:p.value.precio,descripcion:p.value.descripcion,producto_id:u.value}),b=k.value.findIndex(J=>J.id===a.data.id);k.value[b]=a.data,w.dialog({title:"Alerta",message:"Se modifico una variacion."}),x()}catch(a){n.value.error=a.response.data.errors,n.value.type="variacion",d.value=!1,m.value=!0}};return{mainTitle:X,nombre:o,referencia:S,descripcion:P,precio:_,isLoading:d,saveProduct:M,eventSubmit:s,toggleButton:f,isShow:t,isSave:Q,id:u,dialog:m,formError:n,submitVariacion:Z,dataVariacion:p,variaciones:k,columns:z,editVariacion:Y,isShowTable:C,toggleButtonVar:x}}}),O=e=>(ke("data-v-05f843a9"),e=e(),Ce(),e),$e={class:"row justify-center"},De={class:"text-h5"},je={class:"row justify-center"},Ie={class:"col-12 col-md-8 q-mt-md"},Ne={key:0,class:"row product--row bg-indigo-2 q-pa-sm q-mb-md"},Re={class:"col-11 flex items-center"},xe={class:"text-h6 q-ml-sm"},Fe={class:"col-1 text-right"},ze={class:"row justify-center"},Me={key:0,class:"row justify-center"},Ue={class:"col-12 col-md-8"},He={class:"col-12 flex justify-between q-pa-sm"},Ge=O(()=>l("span",{class:"text-h5"},"Variaciones",-1)),Le={class:"col-12 q-mt-lg"},Oe={class:"form-container"},Xe={class:"row justify-center"},Ye={class:"row justify-center q-pa-sm"},Ze=O(()=>l("span",{class:"text-h6 q-ml-sm text-white"},"Alerta",-1)),Ke={class:"row justify-center"},We={class:"text-h8"},Je={key:0};function ea(e,r,w,j,V,u){return y(),B(H,null,[i(_e,{class:"q-pa-md"},{default:g(()=>[l("div",$e,[i(T,{class:"button-back",round:"",color:"blue-8",icon:"arrow_back",onClick:r[0]||(r[0]=o=>this.$router.push({name:"productos"}))}),l("span",De,N(e.mainTitle),1)]),l("div",je,[l("div",Ie,[e.isSave?(y(),B("div",Ne,[l("div",Re,[l("span",xe,"Producto: "+N(e.nombre),1)]),l("div",Fe,[i(T,{class:"button-head",round:"",color:"indigo-12",icon:e.isShow?"expand_less":"expand_more",onClick:e.toggleButton},null,8,["icon","onClick"])])])):q("",!0),e.isShow?(y(),$(L,{key:1,class:"q-gutter-md q-mt-sm",onSubmit:e.eventSubmit},{default:g(()=>[i(A,{outlined:"",modelValue:e.nombre,"onUpdate:modelValue":r[1]||(r[1]=o=>e.nombre=o),label:"Nombre *",hint:"Nombre completo del producto"},null,8,["modelValue"]),i(A,{outlined:"",class:"q-mt-md",modelValue:e.referencia,"onUpdate:modelValue":r[2]||(r[2]=o=>e.referencia=o),label:"Referencia *",hint:"referencia del producto"},null,8,["modelValue"]),i(A,{outlined:"",class:"q-mt-md",filled:"",modelValue:e.precio,"onUpdate:modelValue":r[3]||(r[3]=o=>e.precio=o),label:"Precio *",mask:"#.##","fill-mask":"0","reverse-fill-mask":"",hint:"Decimanles 0.00"},null,8,["modelValue"]),i(A,{outlined:"",class:"q-mt-md",modelValue:e.descripcion,"onUpdate:modelValue":r[4]||(r[4]=o=>e.descripcion=o),label:"Descripcion *",hint:"Descripcion del producto",type:"text",autogrow:""},null,8,["modelValue"]),l("div",ze,[i(T,{loading:e.isLoading,type:"submit",icon:"save",padding:"10px 20px",size:"md",color:"primary",style:{width:"150px"}},{loading:g(()=>[i(G,{class:"on-left"}),R(" Guardando... ")]),default:g(()=>[R(" \xA0Guardar ")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])):q("",!0)])]),e.id?(y(),B("div",Me,[l("div",Ue,[i(be,{color:"blue",class:"q-my-md"}),l("div",He,[Ge,e.isShowTable?q("",!0):(y(),$(T,{key:0,class:"q-ml-md",round:"",color:"indigo-12",icon:"arrow_back_ios_new",onClick:e.toggleButtonVar},null,8,["onClick"])),e.isShowTable?(y(),$(T,{key:1,class:"btn-border q-ml-md",color:"indigo-12",icon:"add",label:"Agregar",onClick:e.toggleButtonVar},null,8,["onClick"])):q("",!0)]),l("div",Le,[e.isShowTable?(y(),$(Pe,{key:0,flat:"",bordered:"",title:"Variaciones del producto",dense:"",rows:e.variaciones,columns:e.columns,"row-key":"id","no-data-label":"Sin variaciones agregadas"},{"body-cell-accion":g(o=>[i(qe,{props:o},{default:g(()=>[i(T,{dense:"",round:"",flat:"",color:"indigo-12",icon:"edit",onClick:S=>e.editVariacion(o)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])):q("",!0),l("div",Oe,[e.isShowTable?q("",!0):(y(),$(L,{key:0,class:"q-gutter-md q-mt-sm",onSubmit:e.submitVariacion},{default:g(()=>[i(A,{outlined:"",class:"q-mt-md",modelValue:e.dataVariacion.referencia,"onUpdate:modelValue":r[5]||(r[5]=o=>e.dataVariacion.referencia=o),label:"Referencia *",hint:"referencia de la variacion"},null,8,["modelValue"]),i(A,{outlined:"",class:"q-mt-md",filled:"",modelValue:e.dataVariacion.precio,"onUpdate:modelValue":r[6]||(r[6]=o=>e.dataVariacion.precio=o),label:"Precio *",mask:"#.##","fill-mask":"0","reverse-fill-mask":"",hint:"Decimanles 0.00"},null,8,["modelValue"]),i(A,{outlined:"",class:"q-mt-md",modelValue:e.dataVariacion.descripcion,"onUpdate:modelValue":r[7]||(r[7]=o=>e.dataVariacion.descripcion=o),label:"Descripcion *",hint:"Descripcion de la variacion",type:"text",autogrow:""},null,8,["modelValue"]),l("div",Xe,[i(T,{type:"submit",icon:"save",padding:"10px 20px",size:"md",color:"cyan-6",style:{width:"150px"}},{loading:g(()=>[i(G,{class:"on-left"}),R(" Guardando... ")]),default:g(()=>[R(" \xA0Guardar ")]),_:1})])]),_:1},8,["onSubmit"]))])])])])):q("",!0)]),_:1}),i(he,{modelValue:e.dialog,"onUpdate:modelValue":r[8]||(r[8]=o=>e.dialog=o),position:"top"},{default:g(()=>[i(ye,{style:{width:"550px"},class:"bg-red"},{default:g(()=>[l("div",Ye,[i(we,{name:"warning",color:"warning",size:"2rem"}),Ze]),i(Ve,{class:"q-pa-sm text-white"},{default:g(()=>[l("div",Ke,[l("span",We,"En el formulario de "+N(e.formError.type)+" se encontraron los siguientes errores",1)]),e.formError?(y(),B("ul",Je,[(y(!0),B(H,null,Se(e.formError.error,(o,S)=>(y(),B("li",{key:S},N(o[0]),1))),128))])):q("",!0),i(Be)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var ua=me(Ee,[["render",ea],["__scopeId","data-v-05f843a9"]]);export{ua as default};
